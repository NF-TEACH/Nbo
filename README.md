# Synbo

בוט סנכרון קבוצות ווצאפ המבוסס על הספרייה [Baileys](https://baileys.wiki/) בגרסת ESM הרשמית.

## מאפיינים

- התחברות לוואטסאפ באמצעות Baileys ושמירת מצב אימות בתיקיית `auth`.
- העברת הודעות מקבוצת מקור יחידה למספר קבוצות יעד עם השהייה אקראית של 5 עד 15 שניות (ניתן לשינוי).
- תמיכה בכל סוגי ההודעות ש-Baileys יודע להעביר (טקסט, מדיה, מסמכים, סטיקרים ועוד) באמצעות העברת ההודעה המקורית.
- שליחת הודעת סיכום חזרה לקבוצת המקור לאחר כל העברה, כולל תצוגה מקדימה ותיעוד שגיאות במקרה הצורך.
- לוגים מפורטים באמצעות `pino`.

## התקנה

1. ודאו כי מותקנת על המחשב גרסת Node.js 18 ומעלה.
2. התקינו את התלויות:

```bash
npm install
```

3. צרו קובץ `.env` בתיקיית הפרויקט על בסיס הדוגמה הבאה:

```
SOURCE_GROUP_JID=123456789-123456789@g.us
TARGET_GROUP_JIDS=111111111-111111111@g.us,222222222-222222222@g.us
MIN_FORWARD_DELAY_MS=5000
MAX_FORWARD_DELAY_MS=15000
LOG_LEVEL=info
```

- `SOURCE_GROUP_JID` – ה-JID של קבוצת המקור (לרוב מסתיים ב-`@g.us`).
- `TARGET_GROUP_JIDS` – רשימת JID של קבוצות היעד, מופרדת בפסיקים.
- `MIN_FORWARD_DELAY_MS` ו-`MAX_FORWARD_DELAY_MS` – טווח ההשהיה האקראית במילישניות (ברירת המחדל 5–15 שניות).
- `LOG_LEVEL` – רמת הלוגים של `pino` (אופציונלי).

## הפעלה

```bash
npm start
```

בעת ההרצה הראשונה תודפס בטרמינל תצוגת QR (בעזרת המנגנון המובנה של Baileys). סרקו אותה באמצעות חשבון הוואטסאפ הייעודי לבוט. לאחר ההזדהות יישמרו נתוני החיבור בתיקיית `auth`.

## מבנה הקוד

הקוד ממודולרי ומחולק לקבצים הבאים:

- `src/index.js` – קובץ הכניסה שמכיל את לוגיקת האתחול, ניהול החיבור והאזנה להודעות.
- `src/config.js` – ניהול הגדרות מהסביבה ובדיקת תקינות בעזרת `zod`.
- `src/forwarding/messageForwarder.js` – אחראי על העברת ההודעה לכל קבוצות היעד והמתנת העיכוב הנדרש.
- `src/messages/messageDescriptor.js` – הפקת תיאור ותצוגה מקדימה של ההודעות לטובת דוחות הסיכום.
- `src/messages/summaryReporter.js` – יצירת הודעת הסיכום ושליחתה לקבוצת המקור.
- `src/utils/delay.js` – פונקציות עזר לעיכובים אקראיים.
- `src/utils/logger.js` – הגדרת מנגנון הלוגים (`pino`).

## הערות

- תיקיית `auth` נכללת ב-`.gitignore` ומכילה מידע רגיש על החיבור. אין להעלות אותה למאגר הקוד.
- במידה והחיבור התנתק לצמיתות (Logged out), מחקו את תיקיית `auth` והפעילו מחדש כדי להתחבר שוב.
